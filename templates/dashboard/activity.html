{% extends "base.html" %}

{% block css %}
{{ block.super }}
<link rel="stylesheet" href="{{ STATIC_URL }}css/activity.css" type="text/css" />
{% endblock %}

{% block js %}
{{ block.super }}
<script>

<!-- TODO: javascript stuff here -->

</script>
{% endblock %}

{% block breadcrumbs %}
  <a class="breadcrumb first-breadcrumb" href="{% url 'dashboard.views.dashboard' %}">Dashboard</a>
{% endblock %}

{% block secondary-toolbar %}
{% include "dashboard/dashboard_toolbar.html" %}
{% endblock %}


{% block content %}

<div class='span12 all-activity'>
    <h2 class='all-activity-header'>All Activity</h2>
        
        <h3>My Code</h3>
            <table class="my-recent-stream">
                {% for notification, snippet in recent_activity_objects %} 
                    {% if notification.seen == False %}

                        {% if notification.comment.chunk.author.username == request.user.username %}
            <!--                Activity Picture, done in CSS-->
                            <tr class="note-line" id="{% if notification.reason == 'V' %}voteup-{{notification.comment.id}}-{{notification.comment.chunk.id}}
                                                      {% else %}comment-{{notification.comment.id}}-{{notification.comment.chunk.id}}
                                                      {% endif %}ALL">
                                <td class="note-image">
                                    <span class="image-{{notification.reason}}"></span>
                                </td>
            <!--                Info on the activity and chunk-->
                                <td class="note-activity">
                                    {% if notification.reason == "C" %}
                                    <span>{{notification.comment.author}} commented on your code!</span>
                                    {% endif %}
                                    {% if notification.reason == "R" %}
                                        <span>{{notification.comment.author}} replied to your comment!</span>
                                    {% endif %}
                                    {% if notification.reason == "V" %}
                                        <span>Someone voted on your comment!</span>
                                    {% endif %}
                                    {% if notification.reason == "U" %}
                                        <span>There is activity on your code!</span>
                                    {% endif %}
                                </td>
                                <td class="note-comment">
                                    <span>{{notification.comment}}</span>
                                    <br>
                                    <span class="grey-text">{{snippet}}</span>
                                </td>
                                <td class="note-on-what">
                                    <span>{{notification.comment.chunk.name}}</span>
                                </td>
                            </tr>
                            
                        {% endif %}

                    {% endif %}
                {% endfor %}    
            </table>
        <h3>Others' Code</h3>
            <table class="others-recent-stream">
                {% for notification, snippet in recent_activity_objects %} 
                    {% if notification.seen == False %}
                
                        {% if notification.comment.chunk.author.username != request.user.username %}
                            <tr class="note-line" id="{% if notification.reason == 'V' %}voteup-{{notification.comment.id}}-{{notification.comment.chunk.id}}
                                                      {% else %}comment-{{notification.comment.id}}-{{notification.comment.chunk.id}}
                                                      {% endif %}ALL">
                                <td class="note-image">
                                    <span class="image-{{notification.reason}}"></span>
                                </td>
            <!--                Info on the activity and chunk-->
                                <td class="note-activity">
                                    {% if notification.reason == "A" %}
                                        <span>There is activity on {{notification.comment.chunk.file.submission.authors.all}}'s code!</span>
                                    {% endif %}
                                    {% if notification.reason == "R" %}
                                        <span>{{notification.comment.author}} replied to your comment!</span>
                                    {% endif %}
                                    {% if notification.reason == "V" %}
                                        <span>Someone voted on your comment!</span>
                                    {% endif %}

                                </td>
                                <td class="note-comment">
                                    <span>{{notification.comment}}</span>
                                    <br>
                                    <span class="grey-text">{{snippet}}</span>
                                </td>
                                <td class="note-on-what">
                                    <span>{{notification.comment.chunk.name}}</span>
                                </td>
                            </tr>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </table>
</div>

{% endblock %}